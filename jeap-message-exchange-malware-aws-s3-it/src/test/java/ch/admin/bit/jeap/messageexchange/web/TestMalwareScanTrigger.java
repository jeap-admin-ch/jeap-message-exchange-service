package ch.admin.bit.jeap.messageexchange.web;

import ch.admin.bit.jeap.messageexchange.malware.api.MalwareScanTrigger;
import lombok.Getter;

import java.io.InputStream;
import java.util.List;
import java.util.concurrent.CopyOnWriteArrayList;

@Getter
class TestMalwareScanTrigger implements MalwareScanTrigger {

    private final List<Trigger> triggers = new CopyOnWriteArrayList<>();

    @Override
    public void triggerScan(String key, String bucketName, InputStream inputStream, int contentLength) {
        triggers.add(new Trigger(key, bucketName));
    }

    void clear() {
        triggers.clear();
    }

    record Trigger(String key, String bucket) {
    }
}

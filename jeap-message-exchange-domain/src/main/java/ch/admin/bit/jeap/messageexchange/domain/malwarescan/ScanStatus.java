package ch.admin.bit.jeap.messageexchange.domain.malwarescan;

import ch.admin.bit.jeap.messageexchange.malware.api.MalwareScanResult;

public enum ScanStatus {
    NOT_SCANNED,
    SCAN_PENDING,
    NO_THREATS_FOUND,
    THREATS_FOUND,
    SCAN_FAILED;

    public static ScanStatus fromScanResult(MalwareScanResult scanResult) {
        return switch (scanResult) {
            case NO_THREATS_FOUND -> ScanStatus.NO_THREATS_FOUND;
            case THREATS_FOUND -> ScanStatus.THREATS_FOUND;
            default -> ScanStatus.SCAN_FAILED;
        };
    }

    public PublishedScanStatus toPublishedScanStatus() {
        return switch (this) {
            case NOT_SCANNED -> PublishedScanStatus.NOT_SCANNED;
            case NO_THREATS_FOUND -> PublishedScanStatus.NO_THREATS_FOUND;
            case THREATS_FOUND -> PublishedScanStatus.THREATS_FOUND;
            default -> PublishedScanStatus.SCAN_FAILED;
        };
    }
}

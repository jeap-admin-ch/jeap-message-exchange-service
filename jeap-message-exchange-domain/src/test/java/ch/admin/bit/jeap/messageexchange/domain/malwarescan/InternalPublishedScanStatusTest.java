package ch.admin.bit.jeap.messageexchange.domain.malwarescan;

import ch.admin.bit.jeap.messageexchange.malware.api.MalwareScanResult;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.*;

class InternalPublishedScanStatusTest {

    @Test
    void fromScanResult() {
        assertEquals(ScanStatus.NO_THREATS_FOUND, ScanStatus.fromScanResult(MalwareScanResult.NO_THREATS_FOUND));
        assertEquals(ScanStatus.THREATS_FOUND, ScanStatus.fromScanResult(MalwareScanResult.THREATS_FOUND));
        assertEquals(ScanStatus.SCAN_FAILED, ScanStatus.fromScanResult(MalwareScanResult.FAILED));
        assertEquals(ScanStatus.SCAN_FAILED, ScanStatus.fromScanResult(MalwareScanResult.ACCESS_DENIED));
        assertEquals(ScanStatus.SCAN_FAILED, ScanStatus.fromScanResult(MalwareScanResult.UNSUPPORTED));
    }

    @Test
    void toPublishedScanStatus() {
        assertEquals(PublishedScanStatus.NOT_SCANNED, ScanStatus.NOT_SCANNED.toPublishedScanStatus());
        assertEquals(PublishedScanStatus.NO_THREATS_FOUND, ScanStatus.NO_THREATS_FOUND.toPublishedScanStatus());
        assertEquals(PublishedScanStatus.THREATS_FOUND, ScanStatus.THREATS_FOUND.toPublishedScanStatus());
        assertEquals(PublishedScanStatus.SCAN_FAILED, ScanStatus.SCAN_FAILED.toPublishedScanStatus());
        assertEquals(PublishedScanStatus.SCAN_FAILED, ScanStatus.SCAN_PENDING.toPublishedScanStatus()); // this should never happen
    }
}

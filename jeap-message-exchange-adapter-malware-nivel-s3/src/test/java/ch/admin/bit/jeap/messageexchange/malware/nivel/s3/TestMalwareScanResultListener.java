package ch.admin.bit.jeap.messageexchange.malware.nivel.s3;

import ch.admin.bit.jeap.messageexchange.malware.api.MalwareScanResult;
import ch.admin.bit.jeap.messageexchange.malware.api.MalwareScanResultListener;

import java.util.HashMap;
import java.util.Map;

class TestMalwareScanResultListener implements MalwareScanResultListener {

    private final Map<ResultReference, MalwareScanResult> results = new HashMap<>();

    @Override
    public void onMalwareScanResult(String key, String bucketName, MalwareScanResult scanResult) {
        results.put(new ResultReference(key, bucketName), scanResult);
    }

    public MalwareScanResult getResult(String key, String bucketName) {
        return results.get(new ResultReference(key, bucketName));
    }

    private record ResultReference(String key, String bucketName) {}
}
